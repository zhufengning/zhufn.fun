---
title: GFSJ0779_梅津美治郎
date: 2022-10-1 23:31
urlname: GFSJ0779
tags: [reverse]
---
Level 1跳过  
静态分析发现假装是Level 2的那个函数里面什么都没有。动态调试也是到那直接退出了  
然后查阅wp发现是使用AddVectoredExceptionHandler注册了异常处理，然后利用int 3触发异常。如果要调试，需要修改调试器设置，让被调试程序处理异常。  
![Windows异常处理](GFSJ0779_%E6%A2%85%E6%B4%A5%E7%BE%8E%E6%B2%BB%E9%83%8E/5da1684e9e9c94eb6f827d586c6e1200.jpg)  
暂时不需要调试，观察注册的异常处理函数，可以发现是和一段字节异或2，但是那段内存是运行时生成的，调试一下。注意这样的是字符串指针，小端的，要倒着看。  
![内存](GFSJ0779_%E6%A2%85%E6%B4%A5%E7%BE%8E%E6%B2%BB%E9%83%8E/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-10-01%20232850.png)  
以02结尾，因为`0^2=2`，代码里也是这样判断结尾的。  
![02](GFSJ0779_%E6%A2%85%E6%B4%A5%E7%BE%8E%E6%B2%BB%E9%83%8E/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-10-01%20233644.png)  
最后把两段和起来。不知道为什么要用下划线拼接。。。`flag{r0b0RUlez!_w3lld0ne}`
